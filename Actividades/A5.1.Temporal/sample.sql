CREATE TABLE COURSE (course_number int NOT NULL, 
TITLE VARCHAR(20) NOT NULL, 
CREDITS SMALLINT NOT NULL WITH DEFAULT 3, 
PRICE DECIMAL (6,2) NOT NULL, 
CSTART DATE NOT NULL, 
CEND DATE NOT NULL, 
PERIOD BUSINESS_TIME(CSTART, CEND),
PRIMARY KEY(COURSE_NUMBER, BUSINESS_TIME WITHOUT OVERLAPS))

insert into COURSE (course_number,TITLE,CREDITS,PRICE,CSTART,CEND)values(1,'DB',5,300,'2017-01-01','2017-06-01')
insert into COURSE (course_number,TITLE,CREDITS,PRICE,CSTART,CEND)values(2,'BDA',8,800,'2017-06-01','2017-12-01')
insert into COURSE (course_number,TITLE,CREDITS,PRICE,CSTART,CEND)values(3,'C++',6,550,'2018-01-01','2018-06-01')
insert into COURSE (course_number,TITLE,CREDITS,PRICE,CSTART,CEND)values(4,'META PROGRMAMING',4,380,'2018-03-01','2018-06-01')
insert into COURSE (course_number,TITLE,CREDITS,PRICE,CSTART,CEND)values(5,'AYMSS',12,900,'2017-08-01','2017-09-01')

select *from COURSE for BUSINESS_TIME as of '2017-05-01'

select *from COURSE for BUSINESS_TIME from '2017-01-01' to  '2017-12-31' 

UPDATE COURSE FOR portion OF BUSINESS_TIME FROM '2018-04-01' TO '2018-05-01'
SET PRICE =200.00
WHERE COURSE_NUMBER = 4

DELETE FROM COURSE FOR portion OF BUSINESS_TIME FROM '2018-02-01' TO '2018-03-01' WHERE COURSE_NUMBER = 3


CREATE TABLE COURSE_SYS (course_number int PRIMARY KEY NOT NULL, 
title varchar(20) NOT NULL, 
credits SMALLINT NOT NULL with default 3, 
price decimal(7, 2) NOT NULL, 
sys_start TIMESTAMP(12) GENERATED ALWAYS AS ROW BEGIN NOT NULL, 
sys_end TIMESTAMP(12) GENERATED ALWAYS AS ROW END NOT NULL,
trans_start TIMESTAMP(12) GENERATED ALWAYS AS TRANSACTION START ID IMPLICITLY HIDDEN, 
period system_time (sys_start, sys_end));


CREATE TABLE COURSE_SYS_HISTORY LIKE COURSE_SYS;

ALTER TABLE COURSE_SYS
ADD versioning
use HISTORY TABLE COURSE_SYS_HISTORY

INSERT INTO COURSE_SYS (COURSE_NUMBER,TITLE,CREDITS,PRICE)VALUES(500,'intro to sql',2,200.00);
INSERT INTO COURSE_SYS (COURSE_NUMBER,TITLE,CREDITS,PRICE)VALUES(600,'intro to ruby',2,250.00);
INSERT INTO COURSE_SYS (COURSE_NUMBER,TITLE,CREDITS,PRICE)VALUES(650,'advance ruby',3,400.00)

UPDATE COURSE_SYS 
SET PRICE =250.00
WHERE COURSE_NUMBER = 650

